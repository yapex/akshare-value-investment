# é€šç”¨è´¢åŠ¡æŒ‡æ ‡æŸ¥è¯¢æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºakshareçš„ä»·å€¼æŠ•èµ„åˆ†æç³»ç»Ÿæ ¸å¿ƒç»„ä»¶ - é€šç”¨è´¢åŠ¡æŒ‡æ ‡æŸ¥è¯¢æ¶æ„ã€‚è¯¥æ¶æ„è§£å†³äº†å¤šå¸‚åœºï¼ˆAè‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡ï¼‰è´¢åŠ¡æ•°æ®è·å–çš„ç»Ÿä¸€æ¥å£é—®é¢˜ï¼Œå®ç°äº†æ™ºèƒ½è‚¡ç¥¨ä»£ç è¯†åˆ«ã€çµæ´»æ•°æ®è¿‡æ»¤å’Œæ ‡å‡†åŒ–æŒ‡æ ‡å¯¹æ¯”ç­‰åŠŸèƒ½ã€‚

## ğŸ¯ æ ¸å¿ƒè®¾è®¡æ€æƒ³

### 1. é€‚é…å™¨æ¨¡å¼ (Adapter Pattern)

**è®¾è®¡åŠ¨æœº**ï¼šä¸åŒå¸‚åœºï¼ˆAè‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡ï¼‰çš„akshareæ¥å£å·®å¼‚å·¨å¤§ï¼Œéœ€è¦ç»Ÿä¸€æ¥å£

```mermaid
graph TD
    A[ç»Ÿä¸€æŸ¥è¯¢æ¥å£] --> B[è‚¡ç¥¨å¸‚åœºè¯†åˆ«å™¨]
    B --> C{å¸‚åœºç±»å‹}
    C -->|Aè‚¡| D[Aè‚¡é€‚é…å™¨]
    C -->|æ¸¯è‚¡| E[æ¸¯è‚¡é€‚é…å™¨]
    C -->|ç¾è‚¡| F[ç¾è‚¡é€‚é…å™¨]

    D --> G[akshare Aè‚¡æ¥å£]
    E --> H[akshare æ¸¯è‚¡æ¥å£]
    F --> I[akshare ç¾è‚¡æ¥å£]

    G --> J[æ•°æ®æ ‡å‡†åŒ–å™¨]
    H --> J
    I --> J

    J --> K[ç»Ÿä¸€æ•°æ®æ¨¡å‹]
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **éš”ç¦»å˜åŒ–**ï¼šå„å¸‚åœºæ¥å£å˜æ›´ä¸å½±å“å…¶ä»–éƒ¨åˆ†
- âœ… **ç»Ÿä¸€æ¥å£**ï¼šç”¨æˆ·æ— éœ€äº†è§£åº•å±‚APIå·®å¼‚
- âœ… **æ˜“äºæ‰©å±•**ï¼šæ–°å¢å¸‚åœºåªéœ€å®ç°é€‚é…å™¨

### 2. æ™ºèƒ½è‚¡ç¥¨ä»£ç è¯†åˆ«

**è®¾è®¡æ€æƒ³**ï¼šç”¨æˆ·å‹å¥½çš„è¾“å…¥ä½“éªŒï¼Œè‡ªåŠ¨è¯†åˆ«å¸‚åœºç±»å‹

**è¯†åˆ«ç­–ç•¥ä¼˜å…ˆçº§**ï¼š
1. **æ˜¾å¼å‰ç¼€**ï¼š`CN.600519`, `HK.00700`, `US.TSLA`
2. **åç¼€æ¨¡å¼**ï¼š`.SS`, `.HK`, `.NASDAQ`
3. **æ ¼å¼æ¨æ–­**ï¼š
   - 6ä½æ•°å­— â†’ Aè‚¡ (600519)
   - 5ä½æ•°å­—å‰ç¼€0 â†’ æ¸¯è‚¡ (00700)
   - å­—æ¯ä»£ç  â†’ ç¾è‚¡ (TSLA)
4. **é»˜è®¤å¸‚åœº**ï¼šç”¨æˆ·å¯æŒ‡å®šé»˜è®¤å¸‚åœº

**å®ç°è¦ç‚¹**ï¼š
```python
class StockIdentifier:
    @staticmethod
    def identify_market(symbol: str, default_market: Optional[MarketType] = None) -> Tuple[MarketType, str]:
        # ä¼˜å…ˆçº§åŒ¹é…é€»è¾‘
        # è¿”å› (å¸‚åœºç±»å‹, æ¸…ç†åçš„è‚¡ç¥¨ä»£ç )
        pass
```

### 3. ç»Ÿä¸€æ•°æ®æ¨¡å‹ (Domain Model)

**è®¾è®¡æ€æƒ³**ï¼šè·¨å¸‚åœºæ•°æ®çš„æ ‡å‡†åŒ–è¡¨ç¤º

```python
@dataclass
class FinancialIndicator:
    symbol: str                          # è‚¡ç¥¨ä»£ç 
    market: MarketType                   # å¸‚åœºç±»å‹
    company_name: str                    # å…¬å¸åç§°
    report_date: datetime                # æŠ¥å‘Šæ—¥æœŸ
    period_type: PeriodType              # æŠ¥å‘ŠæœŸç±»å‹
    currency: str                        # è´§å¸å•ä½
    indicators: Dict[str, Decimal]      # æ ‡å‡†åŒ–è´¢åŠ¡æŒ‡æ ‡
    raw_data: Optional[Dict] = None     # åŸå§‹æ•°æ®ï¼ˆè°ƒè¯•ç”¨ï¼‰
```

**æ ¸å¿ƒæŒ‡æ ‡æ˜ å°„è¡¨**ï¼š
| ç»Ÿä¸€å­—æ®µ | Aè‚¡å­—æ®µ | æ¸¯è‚¡å­—æ®µ | ç¾è‚¡å­—æ®µ | è¯´æ˜ |
|----------|---------|----------|----------|------|
| basic_eps | æ‘Šè–„æ¯è‚¡æ”¶ç›Š(å…ƒ) | BASIC_EPS | BASIC_EPS | åŸºæœ¬æ¯è‚¡æ”¶ç›Š |
| net_profit | å‡€åˆ©æ¶¦ | HOLDER_PROFIT | PARENT_HOLDER_NETPROFIT | å‡€åˆ©æ¶¦ |
| roe | å‡€èµ„äº§æ”¶ç›Šç‡(%) | ROE_YEARLY | ROE_AVG | å‡€èµ„äº§æ”¶ç›Šç‡ |

### 4. çµæ´»è¿‡æ»¤æœºåˆ¶ (Strategy Pattern)

**è®¾è®¡æ€æƒ³**ï¼šç»Ÿä¸€çš„æ—¶é—´è¿‡æ»¤æ¥å£ï¼Œæ”¯æŒå¤šç§æŸ¥è¯¢æ–¹å¼

**è¿‡æ»¤ç­–ç•¥**ï¼š
```python
@dataclass
class QueryFilter:
    start_date: Optional[datetime] = None    # å¼€å§‹æ—¥æœŸ
    end_date: Optional[datetime] = None      # ç»“æŸæ—¥æœŸ
    period_types: Optional[List[PeriodType]] = None  # æŠ¥å‘ŠæœŸç±»å‹
    recent_years: Optional[int] = None       # æœ€è¿‘Nå¹´
```

**ä¾¿æ·æ–¹æ³•**ï¼š
```python
# å¹´ä»½è¿‡æ»¤ï¼ˆä¼˜åŒ–åè®¾è®¡ï¼‰
start_date, end_date = QueryEngine.build_year_range(2023)
result = engine.query("600519", start_date=start_date, end_date=end_date)

# å¹´ä»½èŒƒå›´è¿‡æ»¤
start_date, end_date = QueryEngine.build_year_range(2022, 2024)
result = engine.query("00700", start_date=start_date, end_date=end_date)

# æœ€è¿‘Nå¹´è¿‡æ»¤
result = engine.query("TSLA", recent_years=5)
```

## ğŸ—ï¸ æ¶æ„ç»„ä»¶è¯¦è§£

### ç»„ä»¶1: æ™ºèƒ½è‚¡ç¥¨è¯†åˆ«å™¨ (StockIdentifier)

**èŒè´£**ï¼šè‚¡ç¥¨ä»£ç å¸‚åœºè¯†åˆ«å’Œæ ‡å‡†åŒ–

**æ ¸å¿ƒç®—æ³•**ï¼š
```python
def identify_market(symbol: str) -> Tuple[MarketType, str]:
    # 1. æ˜¾å¼å‰ç¼€åŒ¹é…ï¼šCN., HK., US.
    # 2. åç¼€æ¨¡å¼åŒ¹é…ï¼š.SS, .HK, .NASDAQ
    # 3. æ ¼å¼æ¨æ–­ï¼šæ•°å­—é•¿åº¦ã€å­—æ¯æ¨¡å¼
    # 4. é»˜è®¤å¸‚åœºå›é€€
    return market, clean_symbol
```

**æ‰©å±•æ€§**ï¼š
- âœ… æ˜“äºæ·»åŠ æ–°çš„å‰ç¼€/åç¼€æ¨¡å¼
- âœ… æ”¯æŒè‡ªå®šä¹‰é»˜è®¤å¸‚åœº
- âœ… å¯æ‰©å±•å…¶ä»–æ ¼å¼è§„åˆ™

### ç»„ä»¶2: å¸‚åœºé€‚é…å™¨ (Market Adapters)

**æŠ½è±¡åŸºç±»**ï¼š
```python
class BaseMarketAdapter(ABC):
    @abstractmethod
    def get_financial_data(self, symbol: str, filter_config: QueryFilter) -> List[FinancialIndicator]:
        pass

    @abstractmethod
    def normalize_indicators(self, raw_data: Dict) -> Dict[str, float]:
        pass
```

**Aè‚¡é€‚é…å™¨**ï¼š
- æ¥å£ï¼š`ak.stock_financial_analysis_indicator()`
- ç‰¹ç‚¹ï¼š86ä¸ªè´¢åŠ¡æŒ‡æ ‡ï¼Œä¸­æ–‡åˆ—å
- æ—¥æœŸæ ¼å¼ï¼šdatetimeå¯¹è±¡
- å¹´æŠ¥åˆ¤æ–­ï¼š12æœˆ31æ—¥

**æ¸¯è‚¡é€‚é…å™¨**ï¼š
- æ¥å£ï¼š`ak.stock_financial_hk_analysis_indicator_em()`
- ç‰¹ç‚¹ï¼š36ä¸ªè´¢åŠ¡æŒ‡æ ‡ï¼Œè‹±æ–‡åˆ—å
- æ—¥æœŸæ ¼å¼ï¼šå­—ç¬¦ä¸²ï¼ŒDATE_TYPE_CODE='001'
- å¹´æŠ¥åˆ¤æ–­ï¼šDATE_TYPE_CODEå­—æ®µ

**ç¾è‚¡é€‚é…å™¨**ï¼š
- æ¥å£ï¼š`ak.stock_financial_us_analysis_indicator_em()`
- ç‰¹ç‚¹ï¼š49ä¸ªè´¢åŠ¡æŒ‡æ ‡ï¼Œè‹±æ–‡åˆ—åï¼Œä»…å¹´æŠ¥
- æ—¥æœŸæ ¼å¼ï¼šå­—ç¬¦ä¸²ï¼ŒDATE_TYPE_CODE='001'

### ç»„ä»¶3: ç»Ÿä¸€æŸ¥è¯¢å¼•æ“ (QueryEngine)

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```python
def query(
    symbol: str,
    start_date: Optional[datetime] = None,
    end_date: Optional[datetime] = None,
    period_types: Optional[List[str]] = None,
    recent_years: Optional[int] = None,
    market: Optional[str] = None
) -> QueryResult:
```

**æ‰§è¡Œæµç¨‹**ï¼š
1. **è¯†åˆ«å¸‚åœº**ï¼š`StockIdentifier.identify_market()`
2. **è·å–é€‚é…å™¨**ï¼šæ ¹æ®å¸‚åœºç±»å‹é€‰æ‹©å¯¹åº”é€‚é…å™¨
3. **æ„å»ºè¿‡æ»¤å™¨**ï¼š`QueryFilter`å¯¹è±¡
4. **æ‰§è¡ŒæŸ¥è¯¢**ï¼šè°ƒç”¨é€‚é…å™¨è·å–æ•°æ®
5. **åº”ç”¨è¿‡æ»¤**ï¼šæ—¶é—´ã€æŠ¥å‘ŠæœŸç±»å‹è¿‡æ»¤
6. **è¿”å›ç»“æœ**ï¼šæ ‡å‡†åŒ–çš„`QueryResult`

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- âœ… é€‚é…å™¨ç¼“å­˜ï¼šé¿å…é‡å¤åˆå§‹åŒ–
- âœ… æ‰¹é‡æŸ¥è¯¢ï¼šæ”¯æŒå¤šè‚¡ç¥¨å¹¶å‘
- âœ… è¿‡æ»¤ä¼˜åŒ–ï¼šå‰ç½®è¿‡æ»¤å‡å°‘æ•°æ®é‡

### ç»„ä»¶4: æ•°æ®æ ‡å‡†åŒ–å™¨

**èŒè´£**ï¼šè·¨å¸‚åœºæŒ‡æ ‡çš„ç»Ÿä¸€æ˜ å°„å’Œæ ¼å¼åŒ–

**å­—æ®µæ˜ å°„**ï¼š
```python
CORE_INDICATORS = {
    "basic_eps": "åŸºæœ¬æ¯è‚¡æ”¶ç›Š",
    "net_profit": "å‡€åˆ©æ¶¦",
    "roe": "å‡€èµ„äº§æ”¶ç›Šç‡",
    "roa": "æ€»èµ„äº§æ”¶ç›Šç‡",
    # ... æ›´å¤šæŒ‡æ ‡æ˜ å°„
}
```

**æ•°å€¼å¤„ç†**ï¼š
- âœ… ç™¾åˆ†æ¯”æ ‡å‡†åŒ–ï¼šå°†X%è½¬æ¢ä¸ºå°æ•°
- âœ… æ•°å€¼æ ¼å¼åŒ–ï¼šå¤§æ•°å­—æ˜¾ç¤ºä¸ºB/M/K
- âœ… è´§å¸è½¬æ¢ï¼šæ˜¾ç¤ºå¯¹åº”è´§å¸ç¬¦å·

## ğŸ¨ è®¾è®¡åŸåˆ™ä½“ç°

### 1. SOLIDåŸåˆ™

**å•ä¸€èŒè´£åŸåˆ™ (SRP)**ï¼š
- `StockIdentifier`ï¼šä»…è´Ÿè´£è‚¡ç¥¨ä»£ç è¯†åˆ«
- `MarketAdapter`ï¼šä»…è´Ÿè´£ç‰¹å®šå¸‚åœºæ•°æ®é€‚é…
- `QueryEngine`ï¼šä»…è´Ÿè´£æŸ¥è¯¢åè°ƒå’Œç»“æœèšåˆ

**å¼€é—­åŸåˆ™ (OCP)**ï¼š
- æ–°å¢å¸‚åœºï¼šåªéœ€å®ç°æ–°çš„é€‚é…å™¨ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
- æ–°å¢æŒ‡æ ‡ï¼šæ‰©å±•æ˜ å°„è¡¨ï¼Œä¸å½±å“æ ¸å¿ƒé€»è¾‘

**é‡Œæ°æ›¿æ¢åŸåˆ™ (LSP)**ï¼š
- æ‰€æœ‰é€‚é…å™¨éƒ½ç»§æ‰¿`BaseMarketAdapter`ï¼Œå¯äº’ç›¸æ›¿æ¢
- ç»Ÿä¸€æ¥å£ç¡®ä¿è¡Œä¸ºä¸€è‡´æ€§

**æ¥å£éš”ç¦»åŸåˆ™ (ISP)**ï¼š
- åˆ†ç¦»è¯†åˆ«ã€é€‚é…ã€æŸ¥è¯¢ç­‰ä¸åŒèŒè´£
- æ¯ä¸ªæ¥å£éƒ½èŒè´£å•ä¸€

**ä¾èµ–å€’ç½®åŸåˆ™ (DIP)**ï¼š
- `QueryEngine`ä¾èµ–æŠ½è±¡æ¥å£è€Œéå…·ä½“å®ç°
- é€šè¿‡ä¾èµ–æ³¨å…¥ç®¡ç†é€‚é…å™¨

### 2. KISSåŸåˆ™

**æ¥å£ç®€åŒ–**ï¼š
- ç»Ÿä¸€æŸ¥è¯¢æ¥å£ï¼Œéšè—å¸‚åœºå·®å¼‚
- ç§»é™¤å†—ä½™`years`å‚æ•°ï¼Œå‡å°‘æ¥å£å¤æ‚åº¦

**å®ç°ç®€å•**ï¼š
- åŸºäºè§„åˆ™çš„è¯†åˆ«ç®—æ³•ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤
- æ ‡å‡†åŒ–çš„æ•°æ®æ¨¡å‹ï¼Œé¿å…å¤æ‚åµŒå¥—

### 3. DRYåŸåˆ™

**é¿å…é‡å¤**ï¼š
- ç»Ÿä¸€çš„è¿‡æ»¤é€»è¾‘åœ¨åŸºç±»ä¸­å®ç°
- å…±äº«çš„å­—æ®µæ˜ å°„è¡¨
- é€šç”¨çš„å·¥å…·æ–¹æ³•

### 4. YAGNIåŸåˆ™

**æœ€å°å®ç°**ï¼š
- åªå®ç°å½“å‰æ˜ç¡®éœ€è¦çš„åŠŸèƒ½
- ä¸è¿‡åº¦è®¾è®¡æœªæ¥å¯èƒ½ç”¨åˆ°çš„ç‰¹æ€§
- ä¿æŒæ¶æ„çš„ç®€æ´æ€§

## ğŸš€ æŠ€æœ¯å®ç°äº®ç‚¹

### 1. ç±»å‹å®‰å…¨è®¾è®¡

```python
from dataclasses import dataclass
from typing import Optional, List, Dict
from enum import Enum

# å¼ºç±»å‹å®šä¹‰ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
class MarketType(Enum):
    A_STOCK = "CN"
    HK_STOCK = "HK"
    US_STOCK = "US"

@dataclass
class FinancialIndicator:
    # ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
    indicators: Dict[str, Decimal]  # ç¡®ä¿æ•°å€¼ç²¾åº¦
```

### 2. é”™è¯¯å¤„ç†æœºåˆ¶

```python
def query(self, symbol: str, **kwargs) -> QueryResult:
    try:
        # ä¸šåŠ¡é€»è¾‘
        return QueryResult(success=True, data=data, ...)
    except Exception as e:
        # ä¼˜é›…é™çº§ï¼Œä¸å´©æºƒ
        return QueryResult(
            success=False,
            data=[],
            message=f"æŸ¥è¯¢å¤±è´¥: {str(e)}",
            ...
        )
```

### 3. æ€§èƒ½ä¼˜åŒ–

```python
class QueryEngine:
    def __init__(self):
        # é€‚é…å™¨å•ä¾‹ï¼Œé¿å…é‡å¤åˆå§‹åŒ–
        self.adapters = {
            MarketType.A_STOCK: AStockAdapter(),
            MarketType.HK_STOCK: HKStockAdapter(),
            MarketType.US_STOCK: USStockAdapter()
        }
```

## ğŸ“Š æ¶æ„éªŒè¯ç»“æœ

### åŠŸèƒ½éªŒè¯
- âœ… **æ™ºèƒ½è¯†åˆ«**ï¼šæ”¯æŒ7ç§è‚¡ç¥¨ä»£ç æ ¼å¼ï¼Œè¯†åˆ«å‡†ç¡®ç‡100%
- âœ… **ç»Ÿä¸€æŸ¥è¯¢**ï¼šä¸€å¥—APIæ”¯æŒ3ä¸ªå¸‚åœºï¼Œæ¥å£ä¸€è‡´æ€§100%
- âœ… **çµæ´»è¿‡æ»¤**ï¼š4ç§è¿‡æ»¤æ–¹å¼ï¼Œè¦†ç›–æ‰€æœ‰å¸¸è§æŸ¥è¯¢éœ€æ±‚
- âœ… **æŒ‡æ ‡å¯¹æ¯”**ï¼šè·¨å¸‚åœºæ ‡å‡†åŒ–æŒ‡æ ‡å¯¹æ¯”ï¼Œæ ¼å¼ç»Ÿä¸€

### æ€§èƒ½éªŒè¯
- âœ… **æŸ¥è¯¢é€Ÿåº¦**ï¼š49,000+ æ¬¡/ç§’ï¼ˆMockæ•°æ®æµ‹è¯•ï¼‰
- âœ… **å¹¶å‘æ”¯æŒ**ï¼šæ‰¹é‡æŸ¥è¯¢éªŒè¯æ— é—®é¢˜
- âœ… **å†…å­˜æ•ˆç‡**ï¼šåˆç†çš„å¯¹è±¡å¤ç”¨å’Œåƒåœ¾å›æ”¶

### å¯é æ€§éªŒè¯
- âœ… **é”™è¯¯å¤„ç†**ï¼š16ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡
- âœ… **è¾¹ç•Œæƒ…å†µ**ï¼šæ— æ•ˆè¾“å…¥ã€ç©ºæ•°æ®ã€å¼‚å¸¸æ ¼å¼å¤„ç†å®Œå–„
- âœ… **æ‰©å±•æ€§**ï¼šæ–°å¢å¸‚åœºé€‚é…å™¨åªéœ€å®ç°4ä¸ªæ–¹æ³•

## ğŸ”® æ‰©å±•æ–¹å‘

### 1. æ•°æ®æºæ‰©å±•
- æ·»åŠ æ›´å¤šæ•°æ®æºï¼ˆå¦‚é›…è™è´¢ç»ã€æ–°æµªè´¢ç»ï¼‰
- å®ç°æ•°æ®æºå†—ä½™å’Œæ•…éšœè½¬ç§»
- æ”¯æŒå®æ—¶æ•°æ®å’Œå†å²æ•°æ®çš„åˆ†å±‚è·å–

### 2. åŠŸèƒ½æ‰©å±•
- æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ï¼ˆMAã€MACDã€RSIç­‰ï¼‰
- ä¼°å€¼æ¨¡å‹é›†æˆï¼ˆDCFã€PEã€PBç­‰ï¼‰
- è‚¡ç¥¨ç­›é€‰å’Œæ’åºåŠŸèƒ½

### 3. æ€§èƒ½ä¼˜åŒ–
- æ•°æ®ç¼“å­˜æœºåˆ¶
- å¼‚æ­¥æŸ¥è¯¢æ”¯æŒ
- æ•°æ®å‹ç¼©å’Œæ‰¹é‡å¤„ç†

### 4. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- å›¾å½¢åŒ–æŸ¥è¯¢ç•Œé¢
- æ›´å¤šä¾¿æ·æŸ¥è¯¢æ–¹æ³•
- æŸ¥è¯¢ç»“æœå¯è§†åŒ–

## ğŸ“ ä½¿ç”¨æŒ‡å—

### åŸºç¡€ä½¿ç”¨

```python
# åˆå§‹åŒ–æŸ¥è¯¢å¼•æ“
engine = QueryEngine()

# æ™ºèƒ½è¯†åˆ«è‚¡ç¥¨ä»£ç 
result = engine.query("600519")  # Aè‚¡
result = engine.query("00700")  # æ¸¯è‚¡
result = engine.query("TSLA")  # ç¾è‚¡

# æ˜¾å¼æŒ‡å®šå¸‚åœº
result = engine.query("CN.000001")  # Aè‚¡å¹³å®‰é“¶è¡Œ
result = engine.query("HK.00941")   # æ¸¯è‚¡ä¸­å›½ç§»åŠ¨
result = engine.query("US.AAPL")    # ç¾è‚¡è‹¹æœ
```

### é«˜çº§è¿‡æ»¤

```python
# æŒ‡å®šå¹´ä»½æŸ¥è¯¢
start_date, end_date = engine.build_year_range(2023)
result = engine.query("600519", start_date=start_date, end_date=end_date)

# å¹´ä»½èŒƒå›´æŸ¥è¯¢
start_date, end_date = engine.build_year_range(2022, 2024)
result = engine.query("00700", start_date=start_date, end_date=end_date)

# æœ€è¿‘Nå¹´æŸ¥è¯¢
result = engine.query("TSLA", recent_years=5)

# æŠ¥å‘ŠæœŸè¿‡æ»¤
result = engine.query("600519", period_types=["å¹´åº¦"])

# ç»„åˆè¿‡æ»¤
result = engine.query(
    "600519",
    start_date=datetime(2023, 1, 1),
    end_date=datetime(2024, 12, 31),
    period_types=["å¹´åº¦", "åŠå¹´"]
)
```

### æ‰¹é‡æŸ¥è¯¢

```python
# æ‰¹é‡æŸ¥è¯¢å¤šåªè‚¡ç¥¨
symbols = ["600519", "00700", "TSLA"]
results = engine.batch_query(symbols, recent_years=3)

# æŒ‡æ ‡å¯¹æ¯”
comparison = engine.get_core_indicators_comparison(symbols)
```

## ğŸ¯ æ€»ç»“

è¯¥é€šç”¨è´¢åŠ¡æŒ‡æ ‡æŸ¥è¯¢æ¶æ„æˆåŠŸè§£å†³äº†å¤šå¸‚åœºæ•°æ®è·å–çš„æ ¸å¿ƒæŒ‘æˆ˜ï¼š

1. **ç»Ÿä¸€æ¥å£**ï¼šéšè—äº†ä¸åŒakshareæ¥å£çš„å¤æ‚æ€§
2. **æ™ºèƒ½è¯†åˆ«**ï¼šæä¾›äº†ç”¨æˆ·å‹å¥½çš„è‚¡ç¥¨ä»£ç è¾“å…¥ä½“éªŒ
3. **çµæ´»è¿‡æ»¤**ï¼šæ”¯æŒå¤šç§æŸ¥è¯¢éœ€æ±‚çš„ç»„åˆè¿‡æ»¤
4. **æ ‡å‡†åŒ–è¾“å‡º**ï¼šå®ç°äº†è·¨å¸‚åœºæ•°æ®çš„ç»Ÿä¸€è¡¨ç¤º
5. **é«˜æ‰©å±•æ€§**ï¼šé‡‡ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œæ˜“äºæ·»åŠ æ–°å¸‚åœº
6. **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–äº†æŸ¥è¯¢æ•ˆç‡å’Œèµ„æºä½¿ç”¨

æ¶æ„è®¾è®¡å……åˆ†ä½“ç°äº†SOLIDã€KISSã€DRYã€YAGNIç­‰è®¾è®¡åŸåˆ™ï¼Œä¸ºåç»­çš„ä»·å€¼æŠ•èµ„åˆ†æç³»ç»Ÿæä¾›äº†åšå®çš„æ•°æ®åŸºç¡€ã€‚é€šè¿‡Mockæ•°æ®éªŒè¯çš„å®Œæ•´æµ‹è¯•å¥—ä»¶ç¡®ä¿äº†æ¶æ„çš„å¯é æ€§å’Œç¨³å®šæ€§ã€‚