# AkShare 美股财务数据分析

## 数据收集时间
2025-11-13

## 数据来源API
- **财务指标**: `ak.stock_financial_us_analysis_indicator_em(symbol='AAPL')`
- **财务三表**: `ak.stock_financial_us_report_em(symbol='AAPL')`

## 数据提供方
- **数据源**: 东方财富 (em)

## 数据文件
- `us_stock_statements_sample.csv` - 美股财务三表数据（窄表结构）
- `us_stock_indicators_sample.csv` - 美股财务指标数据（标准结构）

## 📊 美股财务三表数据分析

### 数据结构
- **行数**: 734行
- **列数**: 9列
- **结构**: 窄表结构

### 关键字段
| 字段名 | 描述 | 示例 |
|--------|------|------|
| SECUCODE | 证券代码 | AAPL.O |
| SECURITY_CODE | 安全代码 | AAPL |
| SECURITY_NAME_ABBR | 证券名称缩写 | 苹果 |
| REPORT_DATE | 报告日期 | 2024-09-28 00:00:00 |
| REPORT_TYPE | 报告类型 | 年报 |
| REPORT | 报告期 | 2024/FY |
| STD_ITEM_CODE | 标准项目代码 | 004001001 |
| AMOUNT | 金额 | 29943000000 |
| ITEM_NAME | 项目名称 | 现金及现金等价物 |

### 窄表结构特点
1. **ITEM_NAME字段**: 存储具体的财务项目名称（如"总资产"、"现金及现金等价物"）
2. **AMOUNT字段**: 存储对应的数值
3. **多期数据**: 同一个ITEM_NAME会出现在多个REPORT_DATE中
4. **分类清晰**: 通过STD_ITEM_CODE可以识别项目类型

### 可用的财务项目（共41个）

#### 资产类项目
1. 现金及现金等价物
2. 短期投资
3. 应收账款
4. 存货
5. 递延所得税资产(流动)
6. 其他流动资产
7. 其他应收款
8. 有价证券投资(流动)
9. **流动资产合计**
10. 物业、厂房及设备
11. 长期投资
12. 有价证券投资(非流动)
13. 无形资产
14. 商誉
15. 递延所得税资产(非流动)
16. 其他非流动资产
17. **非流动资产合计**
18. **总资产**

#### 负债类项目
1. 短期债务
2. 应付账款
3. 应付票据(流动)
4. 递延收入(流动)
5. 预收及预提费用
6. 其他流动负债
7. **流动负债合计**
8. 长期负债(本期部分)
9. 长期负债
10. 递延所得税负债(非流动)
11. 递延收入(非流动)
12. 其他非流动负债
13. 非流动负债其他项目
14. **非流动负债合计**
15. **总负债**

#### 权益类项目
1. 普通股
2. 优先股
3. 留存收益
4. 其他综合收益
5. 归属于母公司股东权益
6. 归属于母公司股东权益其他项目
7. 非运算项目
8. **股东权益合计**
9. **负债及股东权益合计**

### 数据时间范围
- **REPORT_TYPE**: 仅"年报"
- **时间跨度**: 2023年到2025年（最新数据）

## 📈 美股财务指标数据分析

### 数据结构
- **行数**: 26行
- **列数**: 49列
- **结构**: 宽表结构（标准财务指标）

### 关键字段
| 字段名 | 描述 | 示例 |
|--------|------|------|
| REPORT_DATE | 报告日期 | 2025-09-27 00:00:00 |
| FINANCIAL_DATE | 财务日期 | 9-27 |
| CURRENCY | 货币 | 美元 |
| OPERATE_INCOME | 营业收入 | 416161000000 |
| GROSS_PROFIT | 毛利润 | 195201000000 |
| PARENT_HOLDER_NETPROFIT | 净利润 | 112010000000 |
| BASIC_EPS | 基本每股收益 | 7.49 |
| ROE_AVG | 净资产收益率 | 0.893293 |
| ROA | 总资产收益率 | 0.673074 |
| DEBT_ASSET_RATIO | 资产负债率 | 387.218749 |

### 标准结构特点
1. **每行一个报告期**: 每行代表一个财年的完整财务指标
2. **每列一个指标**: 49个标准财务指标
3. **包含增长率**: 很多指标都有同比增长率（_YOY后缀）
4. **计算指标**: 包含ROE、ROA等计算得出的指标

## 🔍 窄表vs标准结构对比

### 窄表结构（财务三表）
**优势**:
- 灵活性高，可以轻松添加新的财务项目
- 适合原始财务报表数据
- 支持多层级的项目分类

**劣势**:
- 需要进行数据筛选和转换
- 查询特定字段需要额外处理
- 数据分析相对复杂

### 标准结构（财务指标）
**优势**:
- 查询简单，直接使用列名
- 适合标准化的财务指标
- 数据分析方便

**劣势**:
- 灵活性差，添加新指标需要修改结构
- 需要预先计算和存储所有指标

## 💡 系统设计启示

### 1. 混合架构设计
根据分析结果，系统应该同时支持两种数据结构：
- **财务指标**: 使用标准结构，直接查询
- **财务三表**: 使用窄表结构，通过配置映射

### 2. 字段映射策略
```yaml
# 标准字段（财务指标）
"ROE_AVG":
  name: "净资产收益率"
  keywords: ["ROE", "净资产收益率", "股东回报率"]

# 窄表字段（财务三表）
"总资产":
  name: "总资产"
  keywords: ["总资产", "资产总额", "Total Assets"]
  api_field: "ITEM_NAME"
  filter_value: "总资产"
  value_field: "AMOUNT"
  field_type: "narrow"
```

### 3. 查询流程
1. 识别股票市场（美股使用窄表，A股港股使用标准）
2. 根据字段类型选择查询方式
3. 标准字段：直接列名查询
4. 窄表字段：使用ITEM_NAME + AMOUNT模式查询

### 4. 关键技术要点
- **窄表数据筛选**: `df[df['ITEM_NAME'] == filter_value]`
- **多期数据处理**: 按REPORT_DATE分组处理
- **数值提取**: 从AMOUNT字段获取对应数值
- **字段类型识别**: 通过`field.is_narrow_table_field()`判断

## 📋 实现优先级

### 高优先级（核心字段）
基于真实数据，以下是最常用的财务字段：

#### 资产负债表核心字段
1. **总资产** - 最重要的资产指标
2. **总负债** - 最重要的负债指标
3. **股东权益合计** - 净资产
4. **流动资产合计** - 短期偿债能力
5. **流动负债合计** - 短期债务压力
6. **现金及现金等价物** - 现金流状况
7. **应收账款** - 运营效率
8. **存货** - 库存管理

#### 损益表相关字段
虽然数据文件标记为"资产负债表"，但包含了利润表概念的字段：
1. **净利润** - 通过PARENT_HOLDER_NETPROFIT在标准指标中
2. **营业收入** - 通过OPERATE_INCOME在标准指标中

### 中优先级
- 长期负债
- 物业、厂房及设备
- 商誉
- 留存收益

### 低优先级
- 各种递延项目
- 非经营性项目
- 其他杂项

## 🎯 下一步开发重点

1. **完成窄表服务**：基于真实数据结构完善NarrowTableService
2. **更新配置文件**：使用真实的ITEM_NAME值更新配置
3. **集成MCP查询**：让用户能够用自然语言查询这些字段
4. **测试验证**：确保所有核心字段都能正确查询和提取

基于真实数据分析，我们现在的窄表结构设计是正确的，只需要完善实现细节。